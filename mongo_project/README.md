# üíæ –ü—Ä–æ–µ–∫—Ç: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: pip install pymongo
–ó–∞–ø—É—Å–∫ MongoDB Shell: mongosh

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

    /project-root
    ‚îú‚îÄ‚îÄ db.py                 # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    ‚îú‚îÄ‚îÄ user.py               # –ö–ª–∞—Å—Å User
    ‚îú‚îÄ‚îÄ service.py            # –†–∞–±–æ—Ç–∞ —Å —É—Å–ª—É–≥–∞–º–∏
    ‚îú‚îÄ‚îÄ utils.py              # –£—Ç–∏–ª–∏—Ç—ã: –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è
    ‚îú‚îÄ‚îÄ data_init.py          # –ü–µ—Ä–≤–∏—á–Ω–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î
    ‚îú‚îÄ‚îÄ test_user.py          # –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    ‚îî‚îÄ‚îÄ README.md             # –≠—Ç–æ—Ç —Ñ–∞–π–ª

---

### üìÇ –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

    show dbs                     // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    use mydb                     // –ü–µ—Ä–µ–π—Ç–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö mydb
    use newdb                    // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö newdb // —á—Ç–æ–±—ã –µ–µ —É–≤–∏–¥–µ—Ç—å, –Ω–∞–¥–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é
    db.createCollection('dc')    // –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é
    db.dc.insertOne({"name": "N", "country": "USA"})    // –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ (–º–æ–∂–Ω–æ —Å—Ä–∞–∑—É, –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏)
    db.dc.insertMany([{}, {}, {}])   // –°–æ–∑–¥–∞—Ç—å –º–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
    db.dc.find()                 // –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏
    db.dropDatabase()            // –£–¥–∞–ª–∏—Ç—å —Ç–µ–∫—É—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

### üìÅ –†–∞–±–æ—Ç–∞ —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏

    show collections             // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
    db.users.find().pretty()     // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    db.services.find()           // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏
    db.users.deleteMany({})      // –£–¥–∞–ª–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    db.services.deleteMany({})   // –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏

### ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤—Ä—É—á–Ω—É—é

    db.users.insertOne({
      name: "–ê–ª–µ–∫—Å–µ–π",
      login: "aleksei_01",
      password: "Password123",
      is_blocked: false,
      subscription_date: new Date(),
      subscription_mode: "free",
      services: []
    })

    db.services.insertOne({
      name: "Premium",
      type: 1,
      cost: 500,
      period_days: 30
    })

### ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ

    db.users.updateOne(
      { login: "aleksei_01" },
      { $set: { is_blocked: true } }
    )

    db.users.deleteOne({ login: "aleksei_01" })

### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# –ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é (1) –∏–ª–∏ —É–±—ã–≤–∞–Ω–∏—é (-1)
db.collection.find().sort({ –ø–æ–ª–µ: 1 })       # –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
db.collection.find().sort({ –ø–æ–ª–µ: -1 })      # –ø–æ —É–±—ã–≤–∞–Ω–∏—é

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—è–º
db.collection.find().sort({ –ø–æ–ª–µ1: 1, –ø–æ–ª–µ2: -1 })

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
db.collection.find().sort({ –ø–æ–ª–µ: 1 }).limit(5)

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å –ø—Ä–æ–ø—É—Å–∫–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
db.collection.find().sort({ –ø–æ–ª–µ: -1 }).skip(10).limit(5)


### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ MongoDB —Å —É—Å–ª–æ–≤–∏—è–º–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

# –û–±—â–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:
db.collection.find(–£—Å–ª–æ–≤–∏–µ).sort({ –ø–æ–ª–µ: 1 –∏–ª–∏ -1 })

# –£—Å–ª–æ–≤–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
# ‚Äî —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ
{ "field": "value" }

# ‚Äî –±–æ–ª—å—à–µ, –º–µ–Ω—å—à–µ –∏ —Ç.–¥.
{ "field": { $gt: –∑–Ω–∞—á–µ–Ω–∏–µ } }     # –±–æ–ª—å—à–µ
{ "field": { $lt: –∑–Ω–∞—á–µ–Ω–∏–µ } }     # –º–µ–Ω—å—à–µ
{ "field": { $gte: –∑–Ω–∞—á–µ–Ω–∏–µ } }    # –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ
{ "field": { $lte: –∑–Ω–∞—á–µ–Ω–∏–µ } }    # –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ
{ "field": { $ne: –∑–Ω–∞—á–µ–Ω–∏–µ } }     # –Ω–µ —Ä–∞–≤–Ω–æ

# ‚Äî –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
{ $or: [ { –ø–æ–ª–µ1: –∑–Ω–∞—á–µ–Ω–∏–µ }, { –ø–æ–ª–µ2: –∑–Ω–∞—á–µ–Ω–∏–µ } ] }
{ $and: [ { –ø–æ–ª–µ1: –∑–Ω–∞—á–µ–Ω–∏–µ1 }, { –ø–æ–ª–µ2: –∑–Ω–∞—á–µ–Ω–∏–µ2 } ] }

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

- `updateOne(filter, update)` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç, –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–æ–¥ —Ñ–∏–ª—å—Ç—Ä  
- `updateMany(filter, update)` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ–¥ —Ñ–∏–ª—å—Ç—Ä  
- `replaceOne(filter, replacement)` ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç—å –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç

---

## –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

| –û–ø–µ—Ä–∞—Ç–æ—Ä  | –û–ø–∏—Å–∞–Ω–∏–µ                                                |
|-----------|---------------------------------------------------------|
| `$set`    | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è                |
| `$unset`  | –£–¥–∞–ª—è–µ—Ç –ø–æ–ª–µ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞                                |
| `$inc`    | –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∏–ª–∏ —É–º–µ–Ω—å—à–∞–µ—Ç —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è         |
| `$push`   | –î–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –º–∞—Å—Å–∏–≤                               |
| `$pull`   | –£–¥–∞–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –º–∞—Å—Å–∏–≤–∞ –ø–æ —É—Å–ª–æ–≤–∏—é                  |
| `$addToSet` | –î–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –º–∞—Å—Å–∏–≤, –µ—Å–ª–∏ –µ–≥–æ —Ç–∞–º –µ—â—ë –Ω–µ—Ç       |
| `$rename` | –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –ø–æ–ª–µ                                     |

---

## üîÑ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ JSON

    // –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ users
    mongoexport --db=mydb --collection=users --out=users.json

    // –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ services
    mongoexport --db=mydb --collection=services --out=services.json

### üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON

    // –ò–º–ø–æ—Ä—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ users
    mongoimport --db=mydb --collection=users --file=users.json --jsonArray

    // –ò–º–ø–æ—Ä—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ services
    mongoimport --db=mydb --collection=services --file=services.json --jsonArray

### üóÑ –ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

    mongodump --db=mydb --out=backup/

### ‚ôªÔ∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞

    mongorestore --db=mydb backup/mydb

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã:

    python data_init.py

2. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ª—É–≥):

    python test_user.py

---

### üìå –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö MongoDB

| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö     | –û–ø–∏—Å–∞–Ω–∏–µ                                          | –ü—Ä–∏–º–µ—Ä                                      |
|----------------|---------------------------------------------------|----------------------------------------------|
| `String`       | –°—Ç—Ä–æ–∫–∞                                            | `"name": "David Bowie"`                     |
| `NumberInt`    | –¶–µ–ª–æ–µ —á–∏—Å–ª–æ (32-–±–∏—Ç–Ω–æ–µ)                          | `"year": NumberInt(1977)`                   |
| `NumberLong`   | –¶–µ–ª–æ–µ —á–∏—Å–ª–æ (64-–±–∏—Ç–Ω–æ–µ)                          | `"views": NumberLong(1234567890)`           |
| `Double`       | –ß–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π                         | `"rating": 8.7`                              |
| `Boolean`      | –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ                               | `"is_active": true`                         |
| `Date`         | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è                                      | `"release_date": ISODate("1977-05-25")`     |
| `Array`        | –ú–∞—Å—Å–∏–≤                                            | `"genres": ["rock", "glam", "pop"]`         |
| `Object`       | –í–ª–æ–∂–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç                                  | `"label": { "name": "EMI", "country": "UK" }` |
| `ObjectId`     | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä MongoDB                 | `_id: ObjectId("64eabc...")`                |
| `Null`         | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è                               | `"middle_name": null`                       |
| `Binary`       | –î–≤–æ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ                                   | `"file": BinData(0, "4a6f686e446f65")`       |
| `Timestamp`    | –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ (–¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω—É–∂–¥)             | `"ts": Timestamp()`                         |
| `Decimal128`   | –í—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–µ –¥–µ—Å—è—Ç–∏—á–Ω—ã–µ —á–∏—Å–ª–∞                    | `"price": NumberDecimal("19.99")`           |
| `Regex`        | –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ                              | `"login": { "$regex": "^admin" }`           |

